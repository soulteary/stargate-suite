# 服务环境变量：Stargate、Warden、Herald
services:
  - id: stargate
    name: Stargate
    open: true
    sections:
      - titleKey: stargateDomainRouting
        envVars:
          - env: AUTH_HOST
            type: text
            labelKey: authHostLabel
            descKey: authHostDesc
            default: "auth.test.localhost"
            placeholder: "auth.test.localhost"
          - env: WARDEN_URL
            type: text
            labelKey: wardenUrlLabel
            descKey: wardenUrlDesc
            default: "http://warden:8081"
            placeholder: "http://warden:8081"
          - env: HERALD_URL
            type: text
            labelKey: heraldUrlLabel
            descKey: heraldUrlDesc
            default: "http://herald:8082"
            placeholder: "http://herald:8082"
          - env: STARGATE_DOMAIN
            type: text
            labelKey: stargateDomainLabel
            descKey: stargateDomainDesc
            default: "auth.test.localhost"
            placeholder: "auth.test.localhost"
          - env: PROTECTED_DOMAIN
            type: text
            labelKey: protectedDomainLabel
            descKey: protectedDomainDesc
            default: "whoami.test.localhost"
            placeholder: "whoami.test.localhost"
          - env: STARGATE_PREFIX
            type: text
            labelKey: stargatePrefixLabel
            descKey: stargatePrefixDesc
            default: "stargate"
            placeholder: "stargate"
          - env: PROTECTED_PREFIX
            type: text
            labelKey: protectedPrefixLabel
            descKey: protectedPrefixDesc
            default: "protected"
            placeholder: "protected"
          - env: USER_HEADER_NAME
            type: text
            labelKey: userHeaderLabel
            descKey: userHeaderDesc
            default: "X-Forwarded-User"
            placeholder: "X-Forwarded-User"
      - titleKey: stargateUi
        envVars:
          - env: LANGUAGE
            type: select
            labelKey: languageLabel
            descKey: languageDesc
            default: zh
            options:
              - value: zh
                labelKey: languageZh
              - value: en
                labelKey: languageEn
              - value: fr
                labelKey: languageFr
              - value: it
                labelKey: languageIt
              - value: ja
                labelKey: languageJa
              - value: de
                labelKey: languageDe
              - value: ko
                labelKey: languageKo
          - env: LOGIN_PAGE_TITLE
            type: text
            labelKey: loginPageTitleLabel
            descKey: loginPageTitleDesc
            placeholder: "Stargate - Login"
          - env: LOGIN_PAGE_FOOTER_TEXT
            type: text
            labelKey: loginPageFooterLabel
            descKey: loginPageFooterDesc
            placeholder: "Copyright © 2024 - Stargate"
          - env: COOKIE_DOMAIN
            type: text
            labelKey: cookieDomainLabel
            descKey: cookieDomainDesc
          - env: WARDEN_ENABLED
            type: checkbox
            labelKey: wardenEnabledLabel
            descKey: wardenEnabledDesc
            default: true
          - env: HERALD_ENABLED
            type: checkbox
            labelKey: heraldEnabledLabel
            descKey: heraldEnabledDesc
            default: true
          - env: WARDEN_CACHE_TTL
            type: number
            labelKey: wardenCacheTtlLabel
            descKey: wardenCacheTtlDesc
            default: "300"
            placeholder: "300"
            min: 1
          - env: WARDEN_OTP_ENABLED
            type: checkbox
            labelKey: wardenOtpEnabledLabel
            descKey: wardenOtpEnabledDesc
            default: false
          - env: LOGIN_SMS_ENABLED
            type: checkbox
            labelKey: loginSmsEnabledLabel
            descKey: loginSmsEnabledDesc
            default: true
          - env: LOGIN_EMAIL_ENABLED
            type: checkbox
            labelKey: loginEmailEnabledLabel
            descKey: loginEmailEnabledDesc
            default: true
          - env: HERALD_TOTP_HMAC_SECRET
            type: text
            labelKey: heraldTotpHmacSecretLabel
            descKey: heraldTotpHmacSecretDesc
            placeholder: ""
            showWhenOption: totpEnabled
          - env: SESSION_STORAGE_ENABLED
            type: checkbox
            labelKey: sessionStorageEnabledLabel
            descKey: sessionStorageDesc
          - env: SESSION_STORAGE_REDIS_ADDR
            type: text
            labelKey: sessionStorageRedisAddrLabel
            descKey: sessionStorageRedisAddrDesc
            placeholder: "localhost:6379"
            showWhenEnv: SESSION_STORAGE_ENABLED
          - env: SESSION_STORAGE_REDIS_PASSWORD
            type: text
            labelKey: sessionStorageRedisPasswordLabel
            descKey: sessionStorageRedisPasswordDesc
            showWhenEnv: SESSION_STORAGE_ENABLED
          - env: SESSION_STORAGE_REDIS_DB
            type: number
            labelKey: sessionStorageRedisDbLabel
            descKey: sessionStorageRedisDbDesc
            default: "0"
            placeholder: "0"
            min: 0
            showWhenEnv: SESSION_STORAGE_ENABLED
          - env: SESSION_STORAGE_REDIS_KEY_PREFIX
            type: text
            labelKey: sessionStorageRedisKeyPrefixLabel
            descKey: sessionStorageRedisKeyPrefixDesc
            placeholder: ""
            showWhenEnv: SESSION_STORAGE_ENABLED
          - env: AUDIT_LOG_ENABLED
            type: checkbox
            labelKey: auditLogEnabledLabel
            descKey: auditLogEnabledDesc
            default: true
          - env: AUDIT_LOG_FORMAT
            type: select
            labelKey: auditLogFormatLabel
            descKey: auditLogFormatDesc
            default: json
            options:
              - value: json
                labelKey: auditLogFormatJson
              - value: text
                labelKey: auditLogFormatText
          - env: DEBUG
            type: checkbox
            labelKey: debugLabel
            descKey: debugDesc
          - env: PORT
            type: text
            labelKey: portLabel
            descKey: portDesc
            placeholder: "80"
      - titleKey: heraldTlsSection
        envVars:
          - env: HERALD_TLS_CA_CERT_FILE
            type: text
            labelKey: heraldTlsCaCertFileLabel
            descKey: heraldTlsCaCertFileDesc
            placeholder: ""
          - env: HERALD_TLS_CLIENT_CERT_FILE
            type: text
            labelKey: heraldTlsClientCertFileLabel
            descKey: heraldTlsClientCertFileDesc
            placeholder: ""
          - env: HERALD_TLS_CLIENT_KEY_FILE
            type: text
            labelKey: heraldTlsClientKeyFileLabel
            descKey: heraldTlsClientKeyFileDesc
            placeholder: ""
          - env: HERALD_TLS_SERVER_NAME
            type: text
            labelKey: heraldTlsServerNameLabel
            descKey: heraldTlsServerNameDesc
            placeholder: ""
      - titleKey: otlpSection
        envVars:
          - env: OTLP_ENABLED
            type: checkbox
            labelKey: otlpEnabledLabel
            descKey: otlpEnabledDesc
            default: false
          - env: OTLP_ENDPOINT
            type: text
            labelKey: otlpEndpointLabel
            descKey: otlpEndpointDesc
            placeholder: "http://localhost:4317"
            showWhenEnv: OTLP_ENABLED
      - titleKey: authRefreshSection
        envVars:
          - env: AUTH_REFRESH_ENABLED
            type: checkbox
            labelKey: authRefreshEnabledLabel
            descKey: authRefreshEnabledDesc
            default: false
          - env: AUTH_REFRESH_INTERVAL
            type: text
            labelKey: authRefreshIntervalLabel
            descKey: authRefreshIntervalDesc
            default: "5m"
            placeholder: "5m"
            showWhenEnv: AUTH_REFRESH_ENABLED
      - titleKey: stepUpSection
        envVars:
          - env: STEP_UP_ENABLED
            type: checkbox
            labelKey: stepUpEnabledLabel
            descKey: stepUpEnabledDesc
            default: false
          - env: STEP_UP_PATHS
            type: text
            labelKey: stepUpPathsLabel
            descKey: stepUpPathsDesc
            placeholder: "/admin*,/api/secret*"
      - titleKey: optionalSensitive
        envVars:
          - env: WARDEN_API_KEY
            type: text
            labelKey: wardenApiKeyLabel
            descKey: wardenApiKeyDesc
            placeholder: "test-warden-api-key"
          - env: HERALD_API_KEY
            type: text
            labelKey: heraldApiKeyLabel
            descKey: heraldApiKeyDesc
            placeholder: "test-herald-api-key"
          - env: HERALD_HMAC_SECRET
            type: text
            labelKey: heraldHmacLabel
            descKey: heraldHmacDesc
            placeholder: "test-hmac-secret"
          - env: WARDEN_OTP_SECRET_KEY
            type: text
            labelKey: wardenOtpSecretKeyLabel
            descKey: wardenOtpSecretKeyDesc
            placeholder: ""
          - env: PASSWORDS
            type: text
            labelKey: passwordsLabel
            descKey: passwordsDesc
            placeholder: "plaintext:pass1|pass2"
  - id: warden
    name: Warden
    open: false
    sections:
      - envVars:
          - env: LOG_LEVEL
            type: select
            labelKey: wardenLogLevelLabel
            descKey: wardenLogLevelDesc
            default: info
            options:
              - value: info
                labelKey: logLevelInfo
              - value: debug
                labelKey: logLevelDebug
              - value: warn
                labelKey: logLevelWarn
              - value: error
                labelKey: logLevelError
          - env: MODE
            type: select
            labelKey: modeLabel
            descKey: modeDesc
            default: ONLY_LOCAL
            options:
              - value: DEFAULT
                labelKey: modeDefault
              - value: REMOTE_FIRST
                labelKey: modeRemoteFirst
              - value: ONLY_REMOTE
                labelKey: modeOnlyRemote
              - value: ONLY_LOCAL
                labelKey: modeOnlyLocal
              - value: LOCAL_FIRST
                labelKey: modeLocalFirst
              - value: REMOTE_FIRST_ALLOW_REMOTE_FAILED
                labelKey: modeRemoteFirstAllowFailed
              - value: LOCAL_FIRST_ALLOW_REMOTE_FAILED
                labelKey: modeLocalFirstAllowFailed
          - env: WARDEN_API_KEY
            type: text
            labelKey: wardenApiKeyLabel
            descKey: wardenApiKeyDesc
            placeholder: "test-warden-api-key"
          - env: INTERVAL
            type: number
            labelKey: intervalLabel
            descKey: intervalDesc
            default: "5"
            placeholder: "5"
            min: 1
          - env: WARDEN_REDIS_PASSWORD
            type: text
            labelKey: wardenRedisPasswordLabel
            descKey: wardenRedisPasswordDesc
          - env: WARDEN_REDIS_PASSWORD_FILE
            type: text
            labelKey: wardenRedisPasswordFileLabel
            descKey: wardenRedisPasswordFileDesc
            placeholder: ""
          - env: WARDEN_REDIS_ENABLED
            type: checkbox
            labelKey: wardenRedisEnabledLabel
            descKey: wardenRedisEnabledDesc
            default: true
          - env: WARDEN_REMOTE_CONFIG
            type: text
            labelKey: wardenRemoteConfigLabel
            descKey: wardenRemoteConfigDesc
            placeholder: "http://example.com/data.json"
          - env: WARDEN_REMOTE_KEY
            type: text
            labelKey: wardenRemoteKeyLabel
            descKey: wardenRemoteKeyDesc
            placeholder: "Bearer token"
          - env: WARDEN_DATA_FILE
            type: text
            labelKey: wardenDataFileLabel
            descKey: wardenDataFileDesc
            default: "/app/data.json"
            placeholder: "/app/data.json"
          - env: WARDEN_HTTP_TIMEOUT
            type: number
            labelKey: wardenHttpTimeoutLabel
            descKey: wardenHttpTimeoutDesc
            default: "5"
            placeholder: "5"
            min: 1
          - env: WARDEN_HTTP_MAX_IDLE_CONNS
            type: number
            labelKey: wardenHttpMaxIdleConnsLabel
            descKey: wardenHttpMaxIdleConnsDesc
            default: "100"
            placeholder: "100"
            min: 1
          - env: WARDEN_HTTP_INSECURE_TLS
            type: checkbox
            labelKey: wardenHttpInsecureTlsLabel
            descKey: wardenHttpInsecureTlsDesc
  - id: herald
    name: Herald
    open: false
    sections:
      - envVars:
          - env: HERALD_TEST_MODE
            type: checkbox
            labelKey: heraldTestModeLabel
            descKey: heraldTestModeDesc
          - env: HERALD_REDIS_PASSWORD
            type: text
            labelKey: heraldRedisPasswordLabel
            descKey: heraldRedisPasswordDesc
          - env: HERALD_REDIS_DB
            type: number
            labelKey: heraldRedisDbLabel
            descKey: heraldRedisDbDesc
            default: "0"
            placeholder: "0"
            min: 0
          - env: CHALLENGE_EXPIRY
            type: text
            labelKey: challengeExpiryLabel
            descKey: challengeExpiryDesc
            default: "5m"
            placeholder: "5m"
          - env: CODE_LENGTH
            type: number
            labelKey: codeLengthLabel
            descKey: codeLengthDesc
            default: "6"
            placeholder: "6"
            min: 4
            max: 8
          - env: MAX_ATTEMPTS
            type: number
            labelKey: maxAttemptsLabel
            descKey: maxAttemptsDesc
            default: "5"
            placeholder: "5"
            min: 1
          - env: PROVIDER_FAILURE_POLICY
            type: select
            labelKey: providerFailurePolicyLabel
            descKey: providerFailurePolicyDesc
            default: soft
            options:
              - value: soft
                labelKey: providerSoft
              - value: strict
                labelKey: providerStrict
          - env: RESEND_COOLDOWN
            type: text
            labelKey: resendCooldownLabel
            descKey: resendCooldownDesc
            default: "60s"
            placeholder: "60s"
          - env: LOCKOUT_DURATION
            type: text
            labelKey: lockoutDurationLabel
            descKey: lockoutDurationDesc
            default: "10m"
            placeholder: "10m"
          - env: IDEMPOTENCY_KEY_TTL
            type: text
            labelKey: idempotencyKeyTtlLabel
            descKey: idempotencyKeyTtlDesc
            default: "0"
            placeholder: "0 or 5m"
          - env: ALLOWED_PURPOSES
            type: text
            labelKey: allowedPurposesLabel
            descKey: allowedPurposesDesc
            default: "login"
            placeholder: "login,reset,bind,stepup"
          - env: RATE_LIMIT_PER_USER
            type: number
            labelKey: rateLimitPerUserLabel
            descKey: rateLimitPerUserDesc
            default: "10"
            placeholder: "10"
            min: 1
          - env: RATE_LIMIT_PER_IP
            type: number
            labelKey: rateLimitPerIpLabel
            descKey: rateLimitPerIpDesc
            default: "5"
            placeholder: "5"
            min: 1
          - env: RATE_LIMIT_PER_DESTINATION
            type: number
            labelKey: rateLimitPerDestLabel
            descKey: rateLimitPerDestDesc
            default: "10"
            placeholder: "10"
            min: 1
      - titleKey: optionalSensitive
        envVars:
          - env: HERALD_API_KEY
            type: text
            labelKey: heraldApiKeyLabel
            descKey: heraldApiKeyDesc
            placeholder: "test-herald-api-key"
          - env: HERALD_HMAC_SECRET
            type: text
            labelKey: heraldHmacLabel
            descKey: heraldHmacDesc
            placeholder: "test-hmac-secret"
          - env: HERALD_HMAC_KEYS
            type: text
            labelKey: heraldHmacKeysLabel
            descKey: heraldHmacKeysDesc
            placeholder: '{"key-id":"secret"}'
          - env: HERALD_TOTP_BASE_URL
            type: text
            labelKey: heraldTotpBaseUrlLabel
            descKey: heraldTotpBaseUrlDesc
            placeholder: "http://herald-totp:8084"
            showWhenOption: totpEnabled
          - env: HERALD_TOTP_API_KEY
            type: text
            labelKey: heraldTotpApiKeyLabel
            descKey: heraldTotpApiKeyDesc
            placeholder: ""
            showWhenOption: totpEnabled
          - env: SERVICE_NAME
            type: text
            labelKey: serviceNameLabel
            descKey: serviceNameDesc
            default: "herald"
            placeholder: "herald"
  - id: herald-totp
    name: herald-totp
    nameKey: heraldTotpName
    open: false
    sections:
      - envVars:
          - env: HERALD_TOTP_IMAGE
            type: text
            labelKey: heraldTotpImageLabel
            descKey: heraldTotpImageDesc
            default: "ghcr.io/soulteary/herald-totp:v0.1.0"
            placeholder: "ghcr.io/soulteary/herald-totp:v0.1.0"
          - env: HERALD_TOTP_PORT
            type: text
            labelKey: heraldTotpPortLabel
            descKey: heraldTotpPortDesc
            default: ":8084"
            placeholder: ":8084"
          - env: HERALD_TOTP_REDIS_ADDR
            type: text
            labelKey: heraldTotpRedisAddrLabel
            descKey: heraldTotpRedisAddrDesc
            default: "herald-redis:6379"
            placeholder: "herald-redis:6379"
          - env: HERALD_TOTP_ENCRYPTION_KEY
            type: text
            labelKey: heraldTotpEncryptionKeyLabel
            descKey: heraldTotpEncryptionKeyDesc
            placeholder: "32-byte-key-for-aes-256!!"
          - env: HERALD_TOTP_EXPOSE_SECRET_IN_ENROLL
            type: checkbox
            labelKey: heraldTotpExposeSecretLabel
            descKey: heraldTotpExposeSecretDesc
            default: true
          - env: LOG_LEVEL
            type: select
            labelKey: heraldTotpLogLevelLabel
            descKey: heraldTotpLogLevelDesc
            default: info
            options:
              - value: info
                labelKey: logLevelInfo
              - value: debug
                labelKey: logLevelDebug
              - value: warn
                labelKey: logLevelWarn
              - value: error
                labelKey: logLevelError
      - titleKey: optionalSensitive
        envVars:
          - env: HERALD_TOTP_API_KEY
            type: text
            labelKey: heraldTotpApiKeyLabel
            descKey: heraldTotpApiKeyDesc
            placeholder: ""
